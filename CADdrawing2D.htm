<!DOCTYPE HTML>

<html>

<head>
	<meta charset="UTF-8">
	<meta meta name="description" content="2D CAD drawing">
	<link rel="shortcut icon" href="./img/ruler-triangle.ico" />
	<title>2D CAD Drawing</title>

	<style>
		body {
			font-family: "Helvetica", "Arial", "FreeSans", "Verdana", "Tahoma", "Lucida Sans", "Lucida Sans Unicode", "Luxi Sans", "sans-serif";
		}
		
		td.menu {
			background: #4679bd;
			color: #fff;
		}
		input.info {
			background: beige;
			border: 0px;
			padding: 2px;
			border-radius: 4px;
			color: dimgrey;
		}
	</style>
	<link rel="stylesheet" type="text/css" href="./jsoneditor/jsoneditor.min.css">

	<script src="./svg-pan-zoom/svg-pan-zoom.js"></script>
	<script src="./jsoneditor/jsoneditor.min.js"></script>
	<script src="./filereader/filereader.js"></script>
	<script src="./JScad2d.js"></script>
</head>

<body>
	<table border="0">
		<tr>
			<td rowspan="3"><img src="./img/ruler-triangle-48.png" alt="icon" /></td>
			<td class="menu">Load a JSON file: </td>
			<td class="menu"><input type="file" id="loadDocument" value="Load" name="f3" class="f3" /></td>
			<td rowspan="4">
				<div id="drawing"></div>
			</td>
		</tr>
		<tr>
			<td class="menu">Save file to: </td>
			<td class="menu">
				<button onclick="JScad2d.saveTextAsFile()">JSON</button>&nbsp;
				<button onclick="JScad2d.saveTextAsSVG()">SVG</button>&nbsp;
			</td>
		</tr>
		<tr>
			<td class="menu">
				<button type="button" onclick="JScad2d.zoom('zoomIn');">Zoom In</button>
				<button type="button" onclick="JScad2d.zoom('zoomOut');">Zoom Out</button>
				<button type="button" onclick="JScad2d.zoom('reset');">Reset</button>
			</td>
			<td class="menu">
				<button type="button" onclick="JScad2d.pan('left');">&#8678;</button>
				<button type="button" onclick="JScad2d.pan('up');">&#8679;</button>
				<button type="button" onclick="JScad2d.pan('down');">&#8681;</button>
				<button type="button" onclick="JScad2d.pan('right');">&#8680;</button>
			</td>
		</tr>
		<tr>
			<td colspan="3">
				<div id="jsoneditor" style="width: 450px; height: 400px;"></div>
			</td>
		</tr>
		<tr>
			<td class="menu" colspan="2">
				<form id="squeleton"> squeleton:
					<input class="messageCheckbox" type="checkbox" onclick="JScad2d.displayClassToggle('squeleton')" value="1" name="Squeleton">
				</form>
				<form id="ptsfillet"> fillet:
					<input class="messageCheckbox" type="checkbox" onclick="JScad2d.displayClassToggle('ptsfillet')" value="2" name="Fillet">
				</form>
				<form id="myForm1"> origin:
					<input class="messageCheckbox" type="checkbox" onclick="JScad2d.drawOrigin()" value="3" name="Origin">
				</form>
				<button type="button" onclick="JScad2d.doDebug();">Debug</button>
				<button onclick="readfile(myUrl)">Example</button>
			</td>
			<td id="nodeinfo" class="menu">
				<span id="outputsqueleton"></span><br>
				x: <input id="nodeinfox" class="info"></input><br>
				y: <input id="nodeinfoy" class="info"></input>
			</td>
		</tr>
	</table>


	<script type="text/javascript">
		// create the editor
		// needed to use JSON Editor
		var container = document.getElementById("jsoneditor");
		var editor = new JSONEditor(container);
		var myUrl = "./examples/Part-spigot1.json";


		/**
		 * Load a JSON document from local disk
		 */
		FileReaderJS.setupInput(document.getElementById('loadDocument'), {
			readAsDefault: 'Text',
			on: {
				load: function(event) {
					// put date read from file to editor object
					editor.setText(event.target.result);
					//doUpdate();
					JScad2d.doInitialization();
				}
			}
		});


		/**
		 * Load a JSON document from server
		 * 
		 * @param {string} url
		 * @param {string} container
		 */
		function readfile(url) {
			"use strict";
			var request = new XMLHttpRequest();
			request.open('GET', url, false); // `false` makes the request synchronous
			request.send(null);
			if (request.status === 200) {
				//document.getElementById(container).innerHTML = request.responseText;
				editor.setText(request.responseText);
				JScad2d.doInitialization();
			}
			return 0;
		}



		/**
		 * destro Click element
		 */
		function destroyClickedElement(myEvent) {
			"use strict";
			document.body.removeChild(myEvent.target);
		} // destroyClickedElement


		/**
		 * Test if str is JSON format
		 * 
		 * @param {string} str
		 * @return {boolean} true or false
		 */
		/*
		function IsJsonString(str) {
			try {
				JSON.parse(str);
			} catch (e) {
				return false;
			}
			return true;
		}
		*/
	</script>


</body>
</html>